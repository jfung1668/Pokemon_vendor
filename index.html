<script>
    const params = new URLSearchParams(window.location.search);
    const cardId = params.get('id');

    fetch('card_data.json')
        .then(res => res.json())
        .then(data => {
            const card = data.find(c => c['Unique Code'] === cardId);
            if (card) {
                document.getElementById('name').innerText = card['Product Name'];
                document.getElementById('set').innerHTML = `Card #${card['Card Number']} | ${card['Card Condition']} | Grade: ${card['Grade']}`;
                document.getElementById('price').innerText = `$${card['Suggested Selling Price (Fair Market)'].toFixed(2)}`;
                
                // Add the Benchmark Section
                const benchmarks = document.createElement('div');
                benchmarks.style.textAlign = 'left';
                benchmarks.style.margin = '20px auto';
                benchmarks.style.maxWidth = '300px';
                benchmarks.style.fontSize = '0.9rem';
                benchmarks.style.background = '#f1f1f1';
                benchmarks.style.padding = '15px';
                benchmarks.style.borderRadius = '10px';
                
                benchmarks.innerHTML = `
                    <div style="margin-bottom:5px"><strong>eBay Last Sold:</strong> $${card['eBay Last Sold']}</div>
                    <div style="margin-bottom:5px"><strong>Price Charting:</strong> $${card['Price Charting Market Price']}</div>
                    <div><strong>Collectr Value:</strong> $${card['Collectr Value']}</div>
                `;
                document.querySelector('.container').appendChild(benchmarks);

                // Fetch Image from API
                const query = encodeURIComponent(`name:"${card['Product Name']}" number:"${card['Card Number']}"`);
                fetch(`https://api.pokemontcg.io/v2/cards?q=${query}`)
                    .then(r => r.json())
                    .then(api => {
                        if(api.data[0]) {
                            const img = document.getElementById('card-img');
                            img.src = api.data[0].images.large;
                            img.style.display = 'block';
                        }
                    });
            }
        });
</script>
